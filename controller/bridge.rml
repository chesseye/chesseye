open Util
let bridge s =
  try
    while true do
      let line = input_line stdin in
      begin match parse_message line with
      | Some m -> Rml_async.safe_emit s m
      | None -> ()
      end
    done
  with
  | _ -> ()
